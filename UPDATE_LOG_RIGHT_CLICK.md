# 更新日志 - 鼠标右键功能添加

## 版本信息
**版本号**: v4.2
**更新日期**: 2026-02-13
**主要变更**: 添加拇指和中指触碰作为鼠标右键功能

## 变更详情

### 🔥 新增功能
- **鼠标右键**: 拇指和中指指尖触碰触发鼠标右键点击
- **手势扩展**: 在原有食指中指控制基础上增加右键功能
- **完整鼠标控制**: 现在支持左键、右键、滚轮和移动的完整鼠标操作

### ✨ 技术实现

#### 1. 手势识别器增强 (`recognition/gesture_recognizer.py`)
- 新增拇指中指指尖距离计算: `thumb_middle_tip_distance`
- 在手势判断逻辑中添加鼠标右键分支
- 保持原有的手势优先级顺序不变
- 确保新功能与其他手势互不冲突

#### 2. 鼠标控制器扩展 (`control/mouse_controller.py`)
- 新增 `_handle_mouse_right_click()` 方法
- 在 `handle_gesture()` 方法中添加鼠标右键处理分支
- 复用现有的点击冷却机制确保操作稳定性
- 添加右键操作的日志输出便于调试

#### 3. 文档更新
- 更新使用说明文档，添加鼠标右键功能介绍
- 补充完整的手势控制列表和触发条件
- 提供参数调整建议和使用技巧

### 📚 功能规格

#### 新增手势
- **手势名称**: 鼠标右键
- **触发方式**: 拇指+中指指尖触碰
- **技术实现**: 计算两指间欧几里得距离
- **触发阈值**: 使用 `click_contact_threshold` 参数
- **操作效果**: 执行单次鼠标右键点击

#### 手势优先级（保持不变）
1. 鼠标点击（拇指+食指）
2. 鼠标右键（拇指+中指） ← 新增
3. 下滚轮（拇指+食指DIP关节）
4. 上滚轮（拇指+食指PIP关节）
5. 鼠标移动（食指+中指伸直靠拢）
6. 握拳/回到桌面（手掌状态检测）

### 🛠️ 代码修改

#### 核心算法增强
```python
# 新增距离计算
thumb_middle_tip_distance = math.sqrt((thumb_tip.x - middle_tip.x)**2 + 
                                    (thumb_tip.y - middle_tip.y)**2)

# 新增手势判断分支
elif thumb_middle_tip_distance < self.thresholds['click_contact']:
    # 拇指和中指指尖触碰 = 鼠标右键
    return "鼠标右键"
```

#### 控制逻辑扩展
```python
def _handle_mouse_right_click(self):
    """处理鼠标右键点击手势"""
    try:
        current_time = time.time()
        
        # 防止过快重复点击
        if current_time - self.last_click_time < self.click_cooldown:
            return
        
        # 执行右键点击
        self.mouse.click(Button.right, 1)
        self.last_click_time = current_time
        print("执行鼠标右键点击")
        
    except Exception as e:
        print(f"鼠标右键点击出错: {e}")
```

### 🧪 测试验证
- [x] 手势识别逻辑正确性测试
- [x] 鼠标右键功能基本测试
- [x] 与其他手势的互斥性验证
- [x] 冷却机制有效性确认
- [x] 文档内容准确性检查

### 📖 用户指南更新
- 详细说明鼠标右键的触发方式和使用场景
- 提供清晰的手势示意图描述
- 补充参数调整建议和故障排除指南
- 更新版本信息和功能列表

## 使用说明

### 新增功能操作
1. **鼠标右键点击**: 将拇指和中指的指尖轻轻触碰即可触发右键菜单
2. **与其他手势配合**: 可以与左键点击、滚轮操作等其他手势无缝切换
3. **应用场景**: 适合需要频繁使用右键菜单的场景，如文件操作、网页浏览等

### 参数建议
- **click_contact_threshold**: 建议保持默认值0.05，可根据手指大小微调
- **click_cooldown**: 200ms的冷却时间有效防止误触，一般无需调整

## 后续计划
- 收集用户反馈，优化右键手势的触发灵敏度
- 考虑添加长按右键的功能扩展
- 探索更多实用的手势组合可能性